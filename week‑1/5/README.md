# Жизненный цикл веб-запроса

## Задание

Что происходит, когда пользователь вводит поисковой запрос в Google и нажимает Enter? Какие промежуточные сущности обрабатывают этот запрос и что происходит перед тем, как на экране отрисовывается изображение с точки зрения сетевого взаимодействия? Модели OSI и TCP/IP, TCP-handshake, DNS-серверы.

## Что происходит, когда пользователь вводит поисковой запрос в Google и нажимает Enter? 

1. Ввод и отправка запроса

Браузер формирует HTTP-запрос и отправляет его на сервер

2. DNS преобразование имени в IP

Перед тем как попасть на сервер Google, браузер должен узнать, какой IP-адрес соответствует домену www.google.com. Это делает DNS (Domain Name System)

- Если IP уже закеширован, то берётся из кэша.

- Если нет, то происходит запрос через цепочку DNS-серверов (локальный → провайдера → корневой → доменный и т.д.), пока не вернётся правильный IP

3. Установление соединения (TCP, TLS)

После получения IP:

    1. Устанавливается TCP-соединение с сервером Google (порт 443, т.к. используется HTTPS)

    2. Затем TLS-рукопожатие (шифрование, обмен ключами), потом создаётся защищённый канал

4. Отправка запроса на сервер

Запрос попадает на балансировщик нагрузки Google, который решает какой дата-центр и какой сервер будет обрабатывать этот конкретный запрос

5. Обработка запроса в поисковой системе

    Запрос обрабатывается сервером, который разбирает текст, запускает поисковые алгоритмы, обращается к своим базам данных. Собирается HTML-страница с результатами поиска

6. Ответ и передача обратно

Ответ отправляется обратно по уже установленному TCP/TLS-соединению.

7. Отрисовка страницы браузером

После получения HTML:

    1. Браузер парсит HTML, начинает строить DOM-дерево

    2. Загружает дополнительные ресурсы (CSS, JS, изображения)

    3. Выполняет скрипты, применяет стили

    4. Рендерит итоговую страницу

## Какие промежуточные сущности обрабатывают этот запрос и что происходит перед тем, как на экране отрисовывается изображение с точки зрения сетевого взаимодействия?

Промежуточные сущности (что участвует в обработке):

    Браузер отправляет запрос, обрабатывает ответ

    DNS-серверы преобразуют домен в IP.

    Балансировщики нагрузки (Google) распределяют запросы между серверами.

    Фронтенд-серверы принимают запрос, добавляют персональные данные.

    Базы данных — хранят индексы, историю, настройки.

## Модель OSI 

Модель OSI (Open Systems Interconnection) — это эталонная модель, разработанная для описания функций телекоммуникационных или вычислительных систем, необходимых для сетевого взаимодействия. Она разделяет процесс сетевого взаимодействия на семь взаимосвязанных уровней. Каждый уровень выполняет специфические функции и взаимодействует с уровнями непосредственно выше и ниже.

Важно заметить, что OSI не указывает какие протоколы должны быть использованы. Она просто описывает как система будет обрабатывать запросы.

### Уровни: 

    7. Прикладной (Application Layer) обеспечивает работу пользовательских приложений (веб-браузеры, электронная почта, файловые протоколы и другие прикладные программы)

    6. Представления (Presentation Layer) преобразует данные в нужный формат (кодирование, шифрование, сжатие)

    5. Сеансовый уровень (Session Layer) контролирует начало, поддержание и завершение сеансов связи (сессий)

    4. Транспортный уровень (Transport Layer) гарантирует доставку данных между приложениями, управляя сегментацией и соединениями 

    3. Сетевой уровень (Network Layer) маршрутизирует пакеты по IP-адресам, выбирая оптимальный путь

    2. Канальный уровень (Data Link Layer) управляет MAC-адресами и обеспечивает надёжную передачу между соседними устройствами, исправляя ошибки 

    1. Физический уровен (Physical Layer) передаёт биты через провода, оптоволокно или радиоволны, определяя характеристики сигналов (Ethernet, WiFi, Bluetooth)


## TCP/IP

TCP/IP -  стек протоколов, который определяет процесс передачи данных в интернете от источника к получателю. Стек включает два основных протокола: TCP (Transmission Control Protocol) и IP (Internet Protocol). Протоколы работают совместно: IP прокладывает маршрут, а TCP следит за корректностью отправки.

### Уровни: 

    4. Прикладной уровень помогает приложениям общаться друг с другом с помощью интерфейсов или API

    3. Транспортный уровень отвечает за передачу данных между устройствами, например, по протоколам TCP и UDP

    2. Межсетевой уровень помогает отдельным сетям общаться друг с другом

    1. Уровень сетевого доступа отвечает за взаимодействие по сетевому оборудованию, например по Ethernet-кабелю или Wi-Fi



## TCP-handshake

Это процесс установления соединения между клиентом и сервером по протоколу TCP (Transmission Control Protocol)

Процесс состоит из трёх шагов:

    1. SYN (с клиента). Клиент инициирует соединение и отправляет SYN-пакет (synchronize) серверу с начальным номером последовательности
    
    2. SYN-ACK (с сервера). Сервер получает SYN, подтверждает его с помощью ACK (acknowledgment), и одновременно отправляет свой SYN, то есть сервер говорит: "Я получил твой запрос и хочу установить соединение"

    3. ACK (с клиента). Клиент получает SYN-ACK, подтверждает его отправкой ACK-пакета. После этого соединение считается установленным, и начинается обмен данными


## DNS-серверы

DNS-серверы - это специализированные компьютеры или группы компьютеров, которые хранят информацию о доменных именах и соответствующих IP-адресах в системе DNS (Domain Name System). Каждый IP-адрес связывается с уникальным доменным именем, что позволяет пользователям легко вводить адреса в браузере, не запоминая сложные числовые комбинации

### Уровни доменов

Домены имеют иерархическую структуру:

- Домен верхнего уровня (TLD): .com, .org, .ru
- Домен второго уровня: google.com, yandex.ru
- Поддомен: mail.google.com, blog.example.com

### Как работает DNS?

    1. вводится адрес сайта в браузере
    2. Компьютер спрашивает DNS-сервер: “Какой IP у этого домена?”
    3. DNS-сервер отвечает: “Этот домен находится по такому-то IP”
    4. Браузер подключается к найденному IP-адресу

### DNS-записи

Основные типы DNS-записей:

- A-запись: связывает домен с IPv4-адресом
- AAAA-запись: связывает домен с IPv6-адресом
- CNAME: создает псевдоним для другого домена
- MX: указывает почтовые серверы
- TXT: хранит текстовую информацию
